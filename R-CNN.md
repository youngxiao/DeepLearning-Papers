# R-CNN

R-CNN(2014，大牛[Ross Girshick](http://www.rossgirshick.info/) )目标检测核心思想：
1. regions proposal
2. BBox regression

主要关注了两个问题：使用深度网络定位物体和在小规模的标注数据集上进行大型网络模型的训练。
与图像分类不同的是检测需要定位一个图像内的许多物体。一个方法是将框定位看做是回归问题。

测试时，我们的方法产生了接近2000个与类别独立的区域推荐，对每个推荐使用CNN抽取了一个固定长度的特征向量，然后借助专门针对特定类别数据的线性SVM对每个区域进行分类。通过简单的技术（仿射变换）从每个推荐区域计算出一个固定大小的CNN输入，从而支持各种区域尺寸。
本文的第二个核心贡献是在辅助数据集（ILSVRC）上进行有监督预训练，再在小数据集上针对特定问题进行调优是在训练数据稀少的情况下一个非常有效的训练大型卷积神经网络的方法。

### R-CNN 目标检测时步骤
##### 1. 生成候选区域（Region proposals）
在测试图像上使用 Selective Search 算法提取2000个候选区域。
##### 2. 利用 CNN 进行 Feature extraction
- 在每个候选框周围加上16个像素值为候选框像素平均值的边框
- 再resize到 227×227 的大小，作为AlexNet（5conv＆2fc）的输入
- Forward propagate 后获取 4096 维的特征，那么2000个候选框的 CNN 特征组合成 2000×4096 维矩阵。
##### 3. 每个类别进行线性 SVM
- 线性 SVM
- 用greedy的NMS（非极大值抑制算法）每个类别：如果有一个候选框与较高得分的候选框的交并比（IoU）超过了学习阈值 threshold，就去掉这个候选框。
##### 4. 线性 bounding-box regression on CNN 特征
- 使用回归器精细修正候选框位置

